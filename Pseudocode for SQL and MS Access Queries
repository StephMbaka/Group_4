Pseudocode for SQL and MS Access Queries
• Add a new customer to the database, including being registered with one of the doctors.
BEGIN
    INPUT patient_name, patient_address, patient_dob, doctor_id
    # Add the new customer
    INSERT INTO Patient (Name, Address, DateOfBirth)
    VALUES (patient_name, patient_address, patient_dob)

    # Get the new patient ID (assuming the system assigns an ID automatically)
    SET patient_id = (SELECT MAX(PatientID) FROM Patient)

    # Register the patient with the doctor
    INSERT INTO PatientDoctor (PatientID, DoctorID)
    VALUES (patient_id, doctor_id)
END
• Modify address details of an existing customer.
BEGIN
    INPUT patient_id, new_address

    # Update the patient's address
    UPDATE Patient
    SET Address = new_address
    WHERE PatientID = patient_id
END
• Print a list of all patient names and addresses for patients registered to doctors 
based at one particular hospital - that could be used for posting information mail to 
all of one hospital’s registered patients.
BEGIN
    INPUT hospital_id

    # Retrieve all patients registered with doctors at the given hospital
    SELECT Patient.Name, Patient.Address
    FROM Patient
    INNER JOIN Doctor ON Patient.DoctorID = Doctor.DoctorID
    WHERE Doctor.HospitalID = hospital_id
END
• Print a list of all doctors based at Teaching hospitals which were accredited between 2015-2024.
BEGIN
    # Retrieve all doctors working at Teaching Hospitals accredited between 2015 and 2024
    SELECT Doctor.Name, Doctor.Specialization
    FROM Doctor
    INNER JOIN Hospital ON Doctor.HospitalID = Hospital.HospitalID
    WHERE Hospital.Type = 'Teaching'
    AND Hospital.AccreditationStatus = 'Accredited'
    AND YEAR(Hospital.AccreditationDate) BETWEEN 2015 AND 2024
END
• List all patients who may have a particular disease based on which medication they have been prescribed.
BEGIN
    INPUT medication_name

    # Find all patients who have been prescribed the given medication
    SELECT DISTINCT Patient.Name, Patient.Address
    FROM Patient
    INNER JOIN Prescription ON Patient.PatientID = Prescription.PatientID
    INNER JOIN Medication ON Prescription.MedicationID = Medication.MedicationID
    WHERE Medication.Name = medication_name
END
• List all doctors based at who specialize in a particular disease.
BEGIN
    INPUT disease_name

    # List all doctors specializing in the given disease
    SELECT DISTINCT Doctor.Name
    FROM Doctor
    INNER JOIN DiseaseDoctor ON Doctor.DoctorID = DiseaseDoctor.DoctorID
    INNER JOIN Disease ON DiseaseDoctor.DiseaseID = Disease.DiseaseID
    WHERE Disease.Name = disease_name
END
• List all lab results for all patients over the age of 60.
BEGIN
    # List all lab results for patients over the age of 60
    SELECT LabResult.TestType, LabResult.Result, Patient.Name
    FROM LabResult
    INNER JOIN Patient ON LabResult.PatientID = Patient.PatientID
    WHERE DATEDIFF(YEAR, Patient.DateOfBirth, CURRENT_DATE) > 60
END
• Print a list of all appointments for a given patient.
BEGIN
    INPUT patient_id

    # Retrieve all appointments for the given patient
    SELECT Appointment.Date, Appointment.Time, Doctor.Name
    FROM Appointment
    INNER JOIN Doctor ON Appointment.DoctorID = Doctor.DoctorID
    WHERE Appointment.PatientID = patient_id
END
• Print a list of all appointments for a given doctor.
BEGIN
    INPUT doctor_id
    # Retrieve all appointments for the given doctor
    SELECT Appointment.Date, Appointment.Time, Patient.Name
    FROM Appointment
    INNER JOIN Patient ON Appointment.PatientID = Patient.PatientID
    WHERE Appointment.DoctorID = doctor_id
END
• Print all prescriptions made from a particular hospital ordered alphabetically by the name of the medication being prescribed - The output of this SQL query should 
include only these 4 columns: the medication name, the name of doctor who 
prescribed it, the name of the patient, and the name of hospital.
BEGIN
    INPUT hospital_id

    # Retrieve prescriptions ordered by the name of the medication
    SELECT Medication.Name, Doctor.Name, Patient.Name, Hospital.Name
    FROM Prescription
    INNER JOIN Doctor ON Prescription.DoctorID = Doctor.DoctorID
    INNER JOIN Patient ON Prescription.PatientID = Patient.PatientID
    INNER JOIN Hospital ON Doctor.HospitalID = Hospital.HospitalID
    INNER JOIN Medication ON Prescription.MedicationID = Medication.MedicationID
    WHERE Hospital.HospitalID = hospital_id
    ORDER BY Medication.Name ASC
END
• Print a list of all lab results from all hospitals that were accredited between 2013-
2020.
BEGIN
    # Retrieve all lab results from hospitals accredited between 2013 and 2020
    SELECT LabResult.TestType, LabResult.Result, Patient.Name, Hospital.Name
    FROM LabResult
    INNER JOIN Patient ON LabResult.PatientID = Patient.PatientID
    INNER JOIN Doctor ON Patient.DoctorID = Doctor.DoctorID
    INNER JOIN Hospital ON Doctor.HospitalID = Hospital.HospitalID
    WHERE YEAR(Hospital.AccreditationDate) BETWEEN 2013 AND 2020
END
• Identify which doctor has made the most prescriptions.
BEGIN
    # Find the doctor who made the most prescriptions
    SELECT Doctor.Name, COUNT(Prescription.PrescriptionID) AS PrescriptionCount
    FROM Prescription
    INNER JOIN Doctor ON Prescription.DoctorID = Doctor.DoctorID
    GROUP BY Doctor.Name
    ORDER BY PrescriptionCount DESC
    LIMIT 1
END
• Print a list of all doctors at the hospital with biggest size (number of beds).
BEGIN
    # Find the hospital with the biggest number of beds
    SELECT MAX(Hospital.Size) AS MaxSize
    FROM Hospital

    // Retrieve all doctors at the hospital with the biggest size
    SELECT Doctor.Name
    FROM Doctor
    INNER JOIN Hospital ON Doctor.HospitalID = Hospital.HospitalID
    WHERE Hospital.Size = MaxSize
END
• A list of all hospital names which were accredited prior to 2015 and do have 
Emergency Service facilities.
BEGIN
    # Retrieve all hospitals accredited prior to 2015 with Emergency Service facilities
    SELECT Hospital.Name
    FROM Hospital
    WHERE Hospital.AccreditationStatus = 'Accredited'
    AND YEAR(Hospital.AccreditationDate) < 2015
    AND Hospital.Type = 'Emergency Service'
END
• A list of patients registered with doctors who are based at hospital with <400 beds
BEGIN
    # Retrieve all patients with doctors based at hospitals with fewer than 400 beds
    SELECT Patient.Name, Patient.Address
    FROM Patient
    INNER JOIN Doctor ON Patient.DoctorID = Doctor.DoctorID
    INNER JOIN Hospital ON Doctor.HospitalID = Hospital.HospitalID
    WHERE Hospital.Size < 400
END
